# äº‘ç‰‡æ»‘å—

> ç½‘ç«™åœ°å€ï¼š aHR0cHM6Ly93d3cueXVucGlhbi5jb20vcHJvZHVjdC9jYXB0Y2hh
>
> https://github.com/Guapisansan/gpss_learn_reverse ä»£ç åœ¨è¿™é‡Œï¼Œä¼šæŒç»­æ›´æ–°é€†å‘æ¡ˆä¾‹

**å…è´£å£°æ˜ï¼š æ­¤æ–‡æ¡£ï¼Œä»¥åŠè„šæœ¬ï¼Œä»…ç”¨æ¥å¯¹æŠ€æœ¯çš„å­¦ä¹ ä¸æ¢è®¨ï¼Œå¦‚æœ‰å†’çŠ¯ï¼Œè¯·è”ç³»ä½œè€…ç”µè¯ï¼Œå¾®ä¿¡13933566015è¿›è¡Œåˆ é™¤**

![image-20230823105731963](äº‘ç‰‡æ»‘å—.assets/image-20230823105731963.png)

æ¥åˆ°è¿™é‡Œ

åˆè¯•ä¸€ä¸‹æ»‘å—ï¼Œå­¦ä¹ ä¸€ä¸‹æ€è·¯

## æ¥å£åˆ†æ

ç‚¹å‡»åˆ·æ–°çœ‹ä¸€ä¸‹å›¾ç‰‡çš„æ¥å£

ä¸€èˆ¬æ»‘å—è‚¯å®šç¦»ä¸å¼€å›¾ç‰‡

![image-20230823105854066](äº‘ç‰‡æ»‘å—.assets/image-20230823105854066.png)

è¿™é‡Œgetæ‰æ˜¯è¯·æ±‚å›¾ç‰‡çš„å…³é”®

![image-20230823105952849](äº‘ç‰‡æ»‘å—.assets/image-20230823105952849.png)

![image-20230823110003159](äº‘ç‰‡æ»‘å—.assets/image-20230823110003159.png)

å“åº”é‡Œæœ‰å¾ˆå¤šä¿¡æ¯ã€‚

è¯•ç€æ‹‰ä¸€ä¸‹æ»‘å—çœ‹ä¸€ä¸‹æ¥å£

![image-20230823111025416](./äº‘ç‰‡æ»‘å—.assets/image-20230823111025416.png)

çœ‹ä¸€ä¸‹è¿™ä¸ªåŒ…çš„è¯·æ±‚ä½“å’Œå“åº”ç»“æœ

![image-20230823111059912](./äº‘ç‰‡æ»‘å—.assets/image-20230823111059912.png)

![image-20230823111106548](./äº‘ç‰‡æ»‘å—.assets/image-20230823111106548.png)

æˆ‘ä»¬å…ˆè·å–ä¸€ä¸‹å›¾ç‰‡æ¥å£

## å›¾ç‰‡æ¥å£

æä¸€æ³¢

**cb**

**i**

**k**

**token**

**captchaId**

å…ˆè¯•è¯•é‡æ”¾æ”»å‡»è¡Œä¸è¡Œçš„é€šã€‚

![image-20230823111704166](./äº‘ç‰‡æ»‘å—.assets/image-20230823111704166.png)

é‡æ”¾äº†å‡ æ¬¡å‘ç°å¯ä»¥æˆåŠŸï¼Œè¯•ç€å»ä¸€ä¸‹å‚æ•°

![image-20230823112121584](./äº‘ç‰‡æ»‘å—.assets/image-20230823112121584.png)

ç›®å‰çœ‹æ¥tokenå¯ä»¥ä¸ç”¨åŠ ï¼Œå…¶ä»–çš„ä¸€ä¸ªä¹Ÿä¸èƒ½å°‘ã€‚

å¯ä»¥é€ä¸€çœ‹çœ‹å‘¢

![image-20230823112716741](./äº‘ç‰‡æ»‘å—.assets/image-20230823112716741.png)

è·Ÿæ ˆè¿›å»

![image-20230823112736663](./äº‘ç‰‡æ»‘å—.assets/image-20230823112736663.png)

**è¿™é‡Œå‘ç°cbï¼Œi ï¼Œ kéƒ½åœ¨è¿™é‡Œ**

cb æ˜¯ç”±äº  

~~~
this.cbManager.preAdd()
~~~

ç”Ÿæˆçš„

r æ˜¯ç”±äº

~~~~
var a = this.encrypt(e);
encodeURIComponent(a.i) 
~~~~

ræ˜¯è¿™æ ·ç”Ÿæˆçš„

kæ˜¯ç”±äº

~~~
encodeURIComponent(a.k)
~~~

ä¹Ÿæ˜¯æ¥è‡ªäºa

### cb

å…ˆçœ‹this.cbManager.preAdd()ç€ä¸ªå‡½æ•°

æ€ä¹ˆç”Ÿæˆçš„

~~~js
 {
            key: "preAdd",
            value: function() {
                for (var t; (t = Math.random().toString(32).replace("0.", ""))in this.pool; )
                    ;
                return this.pool[t] = {
                    ts: 1 / 0
                },
                t
            }
        }
~~~

å¯ä»¥çœ‹åˆ°è¿™ä¸ªpreAddå‡½æ•°æ˜¯éšæœºç”Ÿæˆï¼Œç„¶åæ·»åŠ åˆ°ä¸€ä¸ª this.poolæ± å­é‡Œ

![image-20230823113519278](./äº‘ç‰‡æ»‘å—.assets/image-20230823113519278.png)

æä¸€ä¸‹å¾ˆç®€å•

~~~js
get_cb = function() {
    return  Math.random().toString(32).replace("0.", "")

}
~~~

å†è§£å†³ iå’Œk

### iï¼Œk

è¿™ä¿©æ¥è‡ªäºthis.encrypt

![image-20230823114014597](./äº‘ç‰‡æ»‘å—.assets/image-20230823114014597.png)

æ–­ç‚¹æ‰“åˆ°è¿™é‡Œï¼Œçœ‹åˆ°this.encryptçš„å‚æ•°æ˜¯e

eä¸­åŒ…æ‹¬äº†å¾ˆå¤šä¿¡æ¯

![image-20230823172341127](./äº‘ç‰‡æ»‘å—.assets/image-20230823172341127.png)

å…ˆå†™æ­»äº†

è¿™ä¸ªåœ°æ–¹

è¿›å…¥this.encrypt

![image-20230823173420654](./äº‘ç‰‡æ»‘å—.assets/image-20230823173420654.png)

éå¸¸æ˜æ˜¾çš„aeså¥—rsa

éƒ½å†™è„¸ä¸Šäº†

æ¨¡æ‹Ÿä¸€ä¸‹å­~

![image-20230823173544037](./äº‘ç‰‡æ»‘å—.assets/image-20230823173544037.png)

è¿è¡Œç¼ºå°‘è¿™ä¸ªæ–¹æ³•

![image-20230823173603845](./äº‘ç‰‡æ»‘å—.assets/image-20230823173603845.png)

æ‹¿ä¸‹å•¦æ”¹å§æ”¹å§

![image-20230823173649547](./äº‘ç‰‡æ»‘å—.assets/image-20230823173649547.png)

ç¨å¾®æ”¹ä¸€ä¸‹ï¼Œä¿®ä¿®è¡¥è¡¥

![image-20230823183624914](./äº‘ç‰‡æ»‘å—.assets/image-20230823183624914.png)

è¿™é‡Œæ³¨é‡Šäº†rsaçš„ï¼Œå…ˆæ‹¿åˆ°ä¸€ä¸ªã€‚

åœ¨ærsaçš„

![image-20230823185610473](./äº‘ç‰‡æ»‘å—.assets/image-20230823185610473.png)

å•Šä¸€æµ‹è¯•ï¼Œè¿˜çœŸè¡Œï¼Œ

åœ¨çœ‹ä¸€ä¸‹è¿™ä¸ªcaptchaIdè¿™ä¸ªå‚æ•°

![image-20230824104506864](./äº‘ç‰‡æ»‘å—.assets/image-20230824104506864.png)

åˆ·æ–°é¡µé¢æ–­ç‚¹æ‰“åˆ°è¿™é‡Œï¼Œ

![image-20230824105034614](./äº‘ç‰‡æ»‘å—.assets/image-20230824105034614.png)

æˆ‘è¯•äº†è·Ÿè¿™ä¸ªså‘ç°è·Ÿä¸åˆ°

![image-20230824105330109](./äº‘ç‰‡æ»‘å—.assets/image-20230824105330109.png)

è¯•ç€æœä¸€ä¸‹å€¼è¿™ä¸ªå‘ç°æ˜¯å†™æ­»çš„

![image-20230824105410794](./äº‘ç‰‡æ»‘å—.assets/image-20230824105410794.png)

è¿™é‡Œæœ‰ä¸¤ä¸ªï¼Œçœ‹å‡½æ•°åèƒ½å‘ç°æ˜¯ä¸€ä¸ªç‚¹å‡»çš„ä½ ä¸ªæ»‘åŠ¨

æ»‘åŠ¨çš„å°±æ˜¯974cd565f11545b6a5006d10dc324281

ç‚¹é€‰ä¼°è®¡å°±æ˜¯ 0f6b75adb74b4f62a364b55b6de3b02c

ok

è¿™æ—¶å€™å·²ç»æŠŠè·å–å›¾ç‰‡çš„æ¥å£åšäº†ã€‚

ä¸‹é¢çœ‹æ»‘åŠ¨çš„æ¥å£å§

## æ»‘åŠ¨æ¥å£

![image-20230824105555516](./äº‘ç‰‡æ»‘å—.assets/image-20230824105555516.png)

è¿™é‡Œçœ‹æ»‘åŠ¨æ¥å£çš„å‚æ•°å’Œè·å–å›¾ç‰‡çš„ä¸€æ¨¡ä¸€æ ·

éƒ½æ˜¯cb,i,k,token,captchald

è¿™é‡Œå‘ç°ä¸€ä¸ªé—®é¢˜æ˜¯

![image-20230824105714084](./äº‘ç‰‡æ»‘å—.assets/image-20230824105714084.png)

![image-20230824105743096](./äº‘ç‰‡æ»‘å—.assets/image-20230824105743096.png)

å’Œæ»‘åŠ¨æ¥å£çš„ä¸€æ ·è€¶ã€‚

æ‰€ä»¥æ˜¯ç”±å…³è”æ€§çš„ã€‚

ç„¶å**captchaId** å’±ä»¬ä¹Ÿæ˜¯æ­»çš„

cbä¸Šé¢è§£å†³äº†

é‡ç‚¹æ¥çœ‹è¿™ä¸ªiï¼Œv

**ç®—æ³•è‚¯å®šæ˜¯ä¸€æ ·çš„ä½†æ˜¯å…¥å‚è‚¯å®šä¸åŒï¼ï¼ï¼**

### i,  k

æ–­ç‚¹è¿˜æ˜¯ä¸‹åˆ°è¿™ä¸ªthis.encrypt

![image-20230824110157687](./äº‘ç‰‡æ»‘å—.assets/image-20230824110157687.png)

å‘ç°pointsè¿™ä¸ªæ•°ç»„

é‡Œé¢æ”¾çš„å› è¯¥å°±æ˜¯è½¨è¿¹å§

è¿™ä¸ªæ‰æ˜¯æˆ‘ä»¬æ»‘åŠ¨çš„å…³é”®ã€‚

![image-20230824111734123](./äº‘ç‰‡æ»‘å—.assets/image-20230824111734123.png)

è·Ÿæ ˆå·²ç»è·Ÿåˆ°é¡¶å±‚å‘ç°rå°±å·²ç»æœ‰postionçš„å±æ€§äº†

![image-20230824143514826](./äº‘ç‰‡æ»‘å—.assets/image-20230824143514826.png)

è¿™é‡Œthis.reducPointsç”Ÿæˆäº†è½¨è¿¹æ•°ç»„

ä¸Šé¢æ²¡æœ‰å †æ ˆäº†ï¼Œåªèƒ½è¯´æ˜åœ¨å…¶ä»–çš„åœ°æ–¹ç”Ÿæˆçš„ã€‚

è¿™é‡Œé¦–å…ˆæ£€æŸ¥å…ƒç´ äº‹ä»¶æ–­ç‚¹ï¼Œ**ä¾‹å¦‚æ»‘åŠ¨é¼ æ ‡çš„äº‹ä»¶ç­‰ç­‰**

![image-20230825104634472](./äº‘ç‰‡æ»‘å—.assets/image-20230825104634472.png)

è¿™é‡Œçœ‹åˆ°æœ‰mousemoveé¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼Œè¿›å»æ–­ç‚¹

![image-20230825104707323](./äº‘ç‰‡æ»‘å—.assets/image-20230825104707323.png)

ä»”ç»†é˜…è¯»ï¼Œè¿™æ®µä»£ç 

![image-20230825104924656](./äº‘ç‰‡æ»‘å—.assets/image-20230825104924656.png)

è¿™é‡Œåšä¸€ä¸ªiçš„æ—¥å¿—æ–­ç‚¹ã€‚

è¿™é‡Œ i æœ€åéƒ½åŠ è¿›r.positionæ•°ç»„ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„è½¨è¿¹

![image-20230825105052395](./äº‘ç‰‡æ»‘å—.assets/image-20230825105052395.png)

è¿™é‡Œçœ‹åˆ°äº†è½¨è¿¹çš„å˜åŒ–

æ•°ç»„å…·ä½“é‡Œé¢çš„ï¼Œç”Ÿæˆæˆ‘ä»¬å†çœ‹çœ‹

è¿™å‡ ä¸ªå‚æ•°çš„å‡ºå¤„

å‘ç°ä¸€ä¸ªæ•°ç»„é‡Œé¢æœ‰ä¸‰ä¸ªå€¼

~~~
[parseInt(e.toFixed(2)), parseInt(n.toFixed(2)), Date.now() - r.rawTimestamp];
xè½´						yè½´						æ—¶é—´å·®
~~~

éšç€æˆ‘ä»¬æ‹‰åŠ¨ï¼Œxè½´è¶Šæ¥è¶Šå¤§ï¼Œyè½´æ³¢åŠ¨å¾ˆå°‘ï¼Œ æ—¶é—´å·®é€’å¢

æ¥ç ”ç©¶ä¸€ä¸‹è¿™ä¸ª 1000å¤šæ˜¯æ€ä¹ˆæ¥çš„

æ—¢ç„¶ï¼Œè¿™é‡Œé¼ æ ‡è¶Šæ‹‰è¶Šè¿œï¼Œæ•°å€¼è¶Šæ¥è¶Šå¤§

æˆ‘ä»¬è¯•ä¸€ä¸‹ï¼Œæ»‘åŠ¨å·¦è¾¹çš„æ»‘å—çœ‹çœ‹æ•°å€¼ã€‚

![image-20230825164010287](./äº‘ç‰‡æ»‘å—.assets/image-20230825164010287.png)

å·¦è¾¹çš„ç›´æ¥ï¼Œ

500å¤šå¼€å§‹å¢åŠ 

yè½´ä¹Ÿæ˜¯æ¯”å³è¾¹çš„æ»‘å—ä½

æ‰€ä»¥è¿™ä¸ªxè½´çš„èµ·å§‹ä½ç½®å¤§æ¦‚æ˜¯å›ºå®šçš„

yè½´å¹³ç§»ä¼šæœ‰æ³¢åŠ¨ï¼Œ

æŒ‰ç…§è¿™ä¸ªé€»è¾‘ï¼Œç›´æ¥

å†™ä¸€ä¸ªè½¨è¿¹ç”Ÿæˆé€»è¾‘

![image-20230825164637405](./äº‘ç‰‡æ»‘å—.assets/image-20230825164637405.png)



**æ„æ€å°±æ˜¯ï¼Œç»™ä¸€ä¸ªå›ºå®šçš„èµ·å§‹xå’Œèµ·å§‹yè½´ï¼Œ**

**offsetæ˜¯ç¼ºå£çš„åç§»é‡**

**æ¯æ¬¡å¾ªç¯ï¼Œxè½´éšæœºï¼‹ï¼ˆ1ï¼Œ5ï¼‰éšæœºï¼Œæ¨¡æ‹Ÿå‘å‰æ‹–åŠ¨**

**yè½´éšæœº(-1ï¼Œ1ï¼‰æ¨¡æ‹ŸæŠ–åŠ¨**

**æ—¶é—´æˆ³ä¹Ÿæ˜¯éšæœºï¼ˆ0ï¼Œ60ï¼‰é€’å¢**

**å¦‚æœxè½´å‘å‰ç§»åŠ¨åˆ° åç§»ä½ç½®åœæ­¢å³å¯ã€‚**

è¿™æ ·è½¨è¿¹å°±okäº†

![image-20230825164913160](./äº‘ç‰‡æ»‘å—.assets/image-20230825164913160.png)

è¿™æ · pointså°±æœ‰äº†

![image-20230825171000017](./äº‘ç‰‡æ»‘å—.assets/image-20230825171000017.png)

è¿™é‡Œï¼Œå…¶ä»–çš„éƒ½æ˜¯çš„ 

åªæœ‰è¿™ä¸ª**distanceX**

è¦è§£å†³

è¿™ä¸ªæœä¸€ä¸‹

![image-20230825171058598](./äº‘ç‰‡æ»‘å—.assets/image-20230825171058598.png)

è¿™é‡Œ

![image-20230825171139281](./äº‘ç‰‡æ»‘å—.assets/image-20230825171139281.png)

å›¾ç‰‡imgWidth æ˜¯èƒŒæ™¯å›¾ç‰‡å®½åº¦

 ![image-20230825171424576](./äº‘ç‰‡æ»‘å—.assets/image-20230825171424576.png)

alertImgTagsæ˜¯å°æ»‘å—

![image-20230825171457941](./äº‘ç‰‡æ»‘å—.assets/image-20230825171457941.png)

é€šè¿‡åç§»é‡å¾ˆå¥½è®¡ç®—ã€‚

## è¯†åˆ«ç¼ºå£ä½ç½®

è¿™ä¸ªç¼ºå£ä½ç½®å¾ˆå¤šæ–¹å¼éƒ½å¯ä»¥è¯†åˆ«ï¼Œ

æˆ‘ç”¨çš„cv2è¾¹ç¼˜æ£€æµ‹æå¾—ï¼Œ

ä¹Ÿå¯ä»¥è¿›è¡Œæ·±åº¦å­¦ä¹ æ›´å‡†ç¡®

æˆ–è€…ç”¨ç¬¬ä¸‰æ–¹æ‰“ç å¹³å°

è¶…çº§ğŸ¦…ä¹‹ç±»çš„

# æ€»ç»“ï¼š

ç¬¬ä¸€æ¬¡å®Œæ•´çš„ææ»‘å—å­¦äº†å¾ˆå¤šä¸œè¥¿ã€‚

aesï¼Œrsaä¸¤ç§åŠ å¯†ï¼Œè¿˜æœ‰ç«™ç‚¹è‡ªå·±çš„ä¸€äº›ä¸œè¥¿ï¼Œ

ç¬¬ä¸€æ¬¡æ¨¡æ‹Ÿè½¨è¿¹



çœ‹ä¸€ä¸‹æ•ˆæœ

![image-20230825171716042](./äº‘ç‰‡æ»‘å—.assets/image-20230825171716042.png)

å’Œé¡µé¢çš„æ»‘åŠ¨æ­£ç¡®çš„åšå¯¹æ¯”

![image-20230825171805173](./äº‘ç‰‡æ»‘å—.assets/image-20230825171805173.png)

ç›´æ¥æå®šå˜¿å˜¿

