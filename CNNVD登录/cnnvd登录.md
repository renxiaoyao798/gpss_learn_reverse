# CNNVDç™»å½•

> ç½‘ç«™åœ°å€ï¼š aHR0cHM6Ly93d3cuY25udmQub3JnLmNuL2xvZ2lu  
>
> https://github.com/Guapisansan/gpss_learn_reverse ä»£ç åœ¨è¿™é‡Œï¼Œä¼šæŒç»­æ›´æ–°é€†å‘æ¡ˆä¾‹

**å…è´£å£°æ˜ï¼š æ­¤æ–‡æ¡£ï¼Œä»¥åŠè„šæœ¬ï¼Œä»…ç”¨æ¥å¯¹æŠ€æœ¯çš„å­¦ä¹ ä¸æ¢è®¨ï¼Œå¦‚æœ‰å†’çŠ¯ï¼Œè¯·è”ç³»ä½œè€…ç”µè¯ï¼Œå¾®ä¿¡13933566015è¿›è¡Œåˆ é™¤**

![image-20230720164119956](./cnnvdç™»å½•.assets/image-20230720164119956.png)

å¯¹è¿™ä¸ªcnnvdè¿›è¡Œç™»å½•

## æµç¨‹åˆ†æ

ç”¨æˆ·åï¼Œå¯†ç ï¼ŒéªŒè¯ç ï¼Œ

æˆ‘ä»¬å…ˆéšä¾¿æä¸€ä¸ªï¼Œçœ‹çœ‹è¯·æ±‚ï¼ŒæŠ“ä¸€ä¸‹åŒ…

![image-20230720172028498](./cnnvdç™»å½•.assets/image-20230720172028498.png)

é¦–å…ˆçœ‹åˆ°äº†éªŒè¯ç é”™è¯¯ï¼Œ

![image-20230720172124223](./cnnvdç™»å½•.assets/image-20230720172124223.png)

æˆ‘ä»¬çš„å¯†ç è¢«åŠ å¯†äº†

å…¶ä»–çš„codeå°±æ˜¯æˆ‘è¾“å…¥çš„éªŒè¯ç 

è¿˜æœ‰ä¸€ä¸ªverifyTokenè¿™ä¸ªåŠ å¯†å‚æ•°ï¼Œä¸çŸ¥é“å“ªé‡Œæ¥çš„

### verifyToken

æœä¸€ä¸‹ è¿™ä¸ª

![image-20230720164539591](./cnnvdç™»å½•.assets/image-20230720164539591.png)

æœ‰ä¸¤ä¸ªå…³äºè¿™ä¸ªå‚æ•°çš„ï¼Œ

ç¬¬ä¸€ä¸ªæ˜¯jsé‡Œé¢ï¼Œç¬¬äºŒä¸ªæ˜¯å“åº”é‡Œé¢çš„ï¼Œè¿™ä¸ªå› è¯¥ä¸åŒçš„å›¾ç‰‡çš„tokenä¸ä¸€æ ·

ä½œä¸ºéªŒè¯ç æ ‡è¯†ã€‚

![image-20230720164658127](./cnnvdç™»å½•.assets/image-20230720164658127.png)

![image-20230720164709147](./cnnvdç™»å½•.assets/image-20230720164709147.png)

éªŒè¯ä¸€ä¸‹ç¡®å®å¦‚æ­¤ã€‚

æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹è¯·æ±‚å›¾ç‰‡çœ‹ä¸€ä¸‹ä¼šä¸ä¼šè¿”å›ã€‚

![image-20230720164938772](./cnnvdç™»å½•.assets/image-20230720164938772.png)

ç®€ç®€å•å•è¯•äº†ä¸€ä¸‹ï¼Œä¸éœ€è¦headerå’Œcookie

ä¸‹é¢çœ‹password

### password

è¿™é‡Œæ‰¾password é‡‡ç”¨çš„æ–¹æ³•æ˜¯ çœ‹å †æ ˆï¼Œ

submitform æäº¤è¡¨å•ï¼Œè¯„ç»éªŒç‚¹è¿›å»ï¼Œ

ä¹Ÿå¯ä»¥é€‰æ‹©ä¸‹xhræ–­ç‚¹ï¼Œæˆ–è€…æœç´¢è·Ÿæ ˆï¼Œå› ä¸ºæœç´¢å…³äºpasswordçš„ä¼šæœ‰å¾ˆå¤šï¼Œå½“ç„¶åªè¦èƒ½æ‰¾åˆ°åŠ å¯†ä½ç½®å°±å¯ä»¥ã€‚



![image-20230720165517852](./cnnvdç™»å½•.assets/image-20230720165517852.png)

ç‚¹è¿›å»ï¼Œå‘ç°å¤§å·®ä¸å·®ï¼Œç›´æ¥æ–­ç‚¹å®‰æ’

![image-20230720165657376](./cnnvdç™»å½•.assets/image-20230720165657376.png)

å¯¹å†…å®¹è¿›è¡Œåˆ†æï¼Œmd5åŠ å¯†ï¼Œ

ç”¨123456æµ‹äº†ä¸€ä¸‹æ²¡æœ‰è¿›è¡Œé­”æ”¹ï¼Œmd5è¿˜æ˜¯å¾ˆå¥½å®ç°çš„ï¼Œpythonå°±æœ‰ç°æˆçš„åº“

![image-20230720165814515](./cnnvdç™»å½•.assets/image-20230720165814515.png)

### éªŒè¯ç è¯†åˆ«

ç°åœ¨å‚æ•°æˆ‘ä»¬éƒ½æœ‰äº†ï¼Œè¦è¯†åˆ«éªŒè¯ç äº†ã€‚

è¿™é‡Œé€‰æ‹©çš„ddddocr ä¸€ä¸ªéå¸¸niceçš„è¯†åˆ«åº“

~~~python
import ddddocr
ocr = ddddocr.DdddOcr()
with open('1.png', 'rb') as f:
    img_bytes = f.read()
res = ocr.classification(img_bytes)
print(res)
~~~

æˆ‘ä»¬å°†æ•´ä¸ªæµç¨‹ç©¿èµ·æ¥ï¼Œ

![image-20230720170357536](./cnnvdç™»å½•.assets/image-20230720170357536.png)

åœ¨è¿™ä¸ªè·å–å›¾ç‰‡çš„æ¥å£ä¸­ å›¾ç‰‡æ ¼å¼æ˜¯base64çš„

å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•è¿›è¡Œè·å–

~~~python
import base64
import re

def analysis_base64(src):
    result = re.search("data:image/(?P<ext>.*?);base64,(?P<data>.*)", src, re.DOTALL)
    if result:
        ext = result.groupdict().get("ext")
        data = result.groupdict().get("data")
    else:
        raise Exception("Do not parse!")
    img = base64.urlsafe_b64decode(data)
    return img

~~~

å°†å›¾ç‰‡ä¿å­˜è‡³æœ¬åœ°ï¼Œç„¶åç”¨ddddocrè¿›è¡Œè¯†åˆ«

![image-20230720170852176](./cnnvdç™»å½•.assets/image-20230720170852176.png)

å¯ä»¥çœ‹åˆ°æˆ‘debuggerå’Œå›¾ç‰‡æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœä¸ä¸€æ ·å¯ä»¥å¤šè¯•å‡ æ¬¡ï¼ˆå‡†ç¡®ç‡è¾ƒä½çš„æƒ…å†µï¼Œå¯ä»¥é€‰æ‹©ç¬¬ä¸‰æ–¹æ‰“ç å¹³å°ï¼Œè¶…çº§ğŸ¦…ç±»ä¼¼çš„ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©è‡ªå·±åšæ·±åº¦å­¦ä¹ è¿›è¡Œè®­ç»ƒæ¨¡å‹ï¼‰

![image-20230720171927128](./cnnvdç™»å½•.assets/image-20230720171927128.png)

æ¥å£æ²¡é—®é¢˜ï¼Œè¯•ä¸€ä¸‹æ­£ç¡®çš„ç”¨æˆ·åŠ å¯†ç 

![image-20230720171622110](./cnnvdç™»å½•.assets/image-20230720171622110.png)

ç™»å½•æˆåŠŸ

## æ€»ç»“

cnnvdçš„å¯†ç åŠ å¯†åªæœ‰ä¸€ä¸ªmd5ï¼Œ

æ¯”è¾ƒç®€å•ï¼Œä¸ç”¨è®¾è®¡jsé€†å‘

æ³¨æ„éªŒè¯ç æ¥å£å’Œç™»å½•æ¥å£çš„æµç¨‹å°±å¥½

é€šè¿‡ verifyToken è¿›è¡ŒéªŒè¯ç éªŒè¯ï¼Œ **åœ¨ç™»å½•è¿™ç§è¿ç»­æ€§æ¯”è¾ƒå¼ºçš„åœ°æ–¹å¿…é¡»è¦ç”¨session**